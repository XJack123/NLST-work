# AIåœ¨è‚ºéƒ¨å¥åº·ä¸­çš„åº”ç”¨ï¼šè·¨å¤šä¸ªCTæ‰«ææ•°æ®é›†çš„æ£€æµ‹å’Œè¯Šæ–­æ¨¡å‹åŸºå‡†æµ‹è¯• [![arXiv](https://img.shields.io/badge/arXiv-2405.04605-<color>.svg)](https://arxiv.org/abs/2405.04605)

# æ‘˜è¦

è‚ºç™Œä»ç„¶æ˜¯å…¨çƒç™Œç—‡ç›¸å…³æ­»äº¡çš„ä¸»è¦åŸå› ï¼Œè€Œé€šè¿‡ä½å‰‚é‡è®¡ç®—æœºæ–­å±‚æ‰«æ(LDCT)è¿›è¡Œæ—©æœŸæ£€æµ‹å·²æ˜¾ç¤ºå‡ºåœ¨é™ä½æ­»äº¡ç‡æ–¹é¢çš„å·¨å¤§å‰æ™¯ã€‚éšç€äººå·¥æ™ºèƒ½(AI)åœ¨åŒ»å­¦å½±åƒä¸­çš„æ—¥ç›Šèåˆï¼Œå¼ºå¤§çš„AIæ¨¡å‹çš„å¼€å‘å’Œè¯„ä¼°éœ€è¦è®¿é—®å¤§å‹ã€æ ‡æ³¨è‰¯å¥½çš„æ•°æ®é›†ã€‚åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†æœå…‹å¤§å­¦è‚ºç™Œç­›æŸ¥(DLCS)æ•°æ®é›†çš„å®ç”¨æ€§ï¼Œè¿™æ˜¯æœ€å¤§çš„å¼€æ”¾è®¿é—®LDCTæ•°æ®é›†ï¼Œæ‹¥æœ‰è¶…è¿‡2,000æ¬¡æ‰«æå’Œ3,000ä¸ªä¸“å®¶éªŒè¯çš„ç»“èŠ‚ã€‚æˆ‘ä»¬åœ¨å†…éƒ¨å’Œå¤–éƒ¨æ•°æ®é›†ï¼ˆåŒ…æ‹¬LUNA16ã€LUNA25å’ŒNLST-3D+ï¼‰ä¸Šå¯¹ç”¨äº3Dç»“èŠ‚æ£€æµ‹å’Œè‚ºç™Œåˆ†ç±»çš„æ·±åº¦å­¦ä¹ æ¨¡å‹è¿›è¡Œäº†åŸºå‡†æµ‹è¯•ã€‚å¯¹äºæ£€æµ‹ä»»åŠ¡ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸¤ä¸ªåŸºäºMONAIçš„RetinaNetæ¨¡å‹(DLCSD-mDå’ŒLUNA16-mD)ï¼Œä½¿ç”¨ç«èµ›æ€§èƒ½æŒ‡æ ‡(CPM)è¿›è¡Œè¯„ä¼°ã€‚å¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†äº”ä¸ªæ¨¡å‹ï¼ŒåŒ…æ‹¬æœ€å…ˆè¿›çš„é¢„è®­ç»ƒæ¨¡å‹(Models Genesisã€Med3D)ã€ä¸€ä¸ªè‡ªç›‘ç£åŸºç¡€æ¨¡å‹(FMCB)ã€ä¸€ä¸ªéšæœºåˆå§‹åŒ–çš„ResNet50ï¼Œä»¥åŠæå‡ºçš„ä¸€ä¸ªæ–°é¢–çš„æˆ˜ç•¥çƒ­å¯åŠ¨++(SWS++)æ¨¡å‹ã€‚SWS++ä½¿ç”¨ç²¾é€‰çš„å€™é€‰è¡¥ä¸åœ¨åŒä¸€æ£€æµ‹æµç¨‹å†…é¢„è®­ç»ƒåˆ†ç±»ä¸»å¹²ï¼Œå®ç°äº†ä»»åŠ¡ç›¸å…³çš„ç‰¹å¾å­¦ä¹ ã€‚æˆ‘ä»¬çš„æ¨¡å‹å±•ç¤ºäº†å¼ºå¤§çš„æ³›åŒ–èƒ½åŠ›ï¼ŒSWS++åœ¨å¤šä¸ªæ•°æ®é›†ä¸Šå®ç°äº†ä¸ç°æœ‰åŸºç¡€æ¨¡å‹ç›¸å½“æˆ–æ›´ä¼˜çš„æ€§èƒ½(AUC: 0.71â€“0.90)ã€‚æ‰€æœ‰ä»£ç ã€æ¨¡å‹å’Œæ•°æ®å‡å·²å…¬å¼€å‘å¸ƒï¼Œä»¥ä¿ƒè¿›å¯é‡å¤æ€§å’Œåä½œã€‚è¿™é¡¹å·¥ä½œä¸ºè‚ºç™ŒAIç ”ç©¶å»ºç«‹äº†æ ‡å‡†åŒ–çš„åŸºå‡†æµ‹è¯•èµ„æºï¼Œæ”¯æŒæ¨¡å‹å¼€å‘ã€éªŒè¯å’Œä¸´åºŠè½¬åŒ–æ–¹é¢çš„æœªæ¥å·¥ä½œã€‚


### å¼•ç”¨è®ºæ–‡

[![arXiv](https://img.shields.io/badge/arXiv-2405.04605-<color>.svg)](https://arxiv.org/abs/2405.04605)


```ruby
@article{tushar2024ai,
  title={AI in Lung Health: Benchmarking Detection and Diagnostic Models Across Multiple CT Scan Datasets},
  author={Tushar, Fakrul Islam and Wang, Avivah and Dahal, Lavsen and Harowicz, Michael R and Lafata, Kyle J and Tailor, Tina D and Lo, Joseph Y},
  journal={arXiv preprint arXiv:2405.04605},
  year={2024}
}
```
```ruby
Tushar, Fakrul Islam, et al. "AI in Lung Health: Benchmarking Detection and Diagnostic Models Across Multiple CT Scan Datasets." arXiv preprint arXiv:2405.04605 (2024).
```
### å¼•ç”¨æ•°æ®é›† - Duke Lung

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.13799069.svg)](https://doi.org/10.5281/zenodo.13799069) 
```ruby
A. Wang, F. I. TUSHAR, M. R. Harowicz, K. J. Lafata, T. D. Tailorand J. Y. Lo, "Duke Lung Cancer Screening Dataset 2024". Zenodo, Mar. 05, 2024. doi: 10.5281/zenodo.13799069.
```

## ğŸš€ æ›´æ–°æ—¥å¿—

- **[1] 2025å¹´3æœˆ5æ—¥** - ğŸ“¢ å…¬å¼€å‘å¸ƒ**è®­ç»ƒæ¨¡å‹æƒé‡**ã€‚
- **[2] 2025å¹´3æœˆ7æ—¥** - ğŸ–¼ï¸ æ·»åŠ äº†**DLCSD24**çš„**å¯è§†åŒ–è„šæœ¬**ã€‚
- **[3]** - ğŸ“‚ å…¬å¼€å‘å¸ƒ**é¢„å¤„ç†æ•°æ®é›†** ![å³å°†æ¨å‡º](https://img.shields.io/badge/Status-Coming%20Soon-orange)ã€‚
- **[4]** - ğŸ“Š åœ¨**LUNA25æ•°æ®é›†**ä¸Šè¿›è¡ŒåŸºå‡†æµ‹è¯• ![å³å°†æ¨å‡º](https://img.shields.io/badge/Status-Coming%20Soon-orange)ã€‚
- **[5]** - ğŸ” ä½¿ç”¨**Vista3Dã€nnUNetv2**å’Œ**[SYN-LUNGS](https://github.com/fitushar/SYN-LUNGS)**å¯¹DLCSD24ç»“èŠ‚è¿›è¡Œ**ä¼ªåˆ†å‰²**ã€‚![å³å°†æ¨å‡º](https://img.shields.io/badge/Status-Coming%20Soon-orange)
- **[6]** - âš™ï¸ **åŸºäºMLçš„åˆ†å‰²å’Œæ”¾å°„ç»„å­¦åˆ†ç±»åŸºå‡†æµ‹è¯•** ![å³å°†æ¨å‡º](https://img.shields.io/badge/Status-Coming%20Soon-orange)ã€‚
- **[7]** - ğŸ¯ æ¨¡å‹é¢„æµ‹çš„**äº‹åå¯è§†åŒ–**åŠç›¸å…³ä»£ç  ![å³å°†æ¨å‡º](https://img.shields.io/badge/Status-Coming%20Soon-orange)ã€‚

# ç›¸å…³ç ”ç©¶ï¼š
### ç²¾ç»†åŒ–è‚ºç™ŒAIç„¦ç‚¹ï¼šæ¯”è¾ƒç—…ç¶ä¸­å¿ƒå’Œèƒ¸éƒ¨åŒºåŸŸæ¨¡å‹åŠå†…å¤–éƒ¨éªŒè¯çš„æ€§èƒ½æ´å¯Ÿã€‚ [![arXiv](https://img.shields.io/badge/arXiv-2411.16823-<color>.svg)](https://arxiv.org/abs/2411.16823)
### ç˜¤å‘¨æ‰©å±•æ”¾å°„ç»„å­¦ç”¨äºæ”¹è¿›è‚ºç™Œåˆ†ç±»ã€‚ [![arXiv](https://img.shields.io/badge/arXiv-2411.16008-<color>.svg)](https://arxiv.org/abs/2411.16008)

# åŸºå‡†æ¨¡å‹æƒé‡å¯ä»æ­¤å¤„ä¸‹è½½ï¼š
æ‰€æœ‰å¼€å‘çš„æ¨¡å‹æƒé‡å‡å¯åœ¨ä»¥ä¸‹ä½ç½®å…¬å¼€è·å–ï¼š
ğŸ“¥ Zenodo: https://zenodo.org/records/14967976

Model Genesiså’ŒMedicalNet3Dçš„é¢„è®­ç»ƒæƒé‡å¯ä»æ­¤å¤„ä¸‹è½½ï¼š
* [Genesis_Chest_CT.pt](https://drive.google.com/file/d/16iIIRkl6zYAfQ14i9NOakwFd6w_xKBSY/view?usp=sharing)
* [resnet_50_23dataset.pth](https://drive.google.com/file/d/1dIyJd3jpz9mBx534UA7deqT7f8N0sbJL/view?usp=sharing)




# æ•°æ®é›†

## æœå…‹å¤§å­¦è‚ºç™Œç­›æŸ¥æ•°æ®é›†2024 (DLCS 2024) [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.13799069.svg)](https://doi.org/10.5281/zenodo.13799069) 

**èƒŒæ™¯ï¼š** è‚ºç™Œé£é™©åˆ†ç±»æ˜¯ä¸€ä¸ªæ—¥ç›Šé‡è¦çš„ç ”ç©¶é¢†åŸŸï¼Œå› ä¸ºä½å‰‚é‡èƒ¸éƒ¨CTç­›æŸ¥é¡¹ç›®å·²æˆä¸ºè‚ºç™Œé«˜å±æ‚£è€…çš„æ ‡å‡†æŠ¤ç†ã€‚ç›®å‰ç¼ºä¹å¤§å‹ã€æ ‡æ³¨å®Œå–„çš„å…¬å…±æ•°æ®åº“ç”¨äºè‚ºç»“èŠ‚åˆ†ç±»ç®—æ³•çš„è®­ç»ƒå’Œæµ‹è¯•ã€‚

**æ–¹æ³•ï¼š** æœ¬ç ”ç©¶è€ƒè™‘äº†2015å¹´1æœˆ1æ—¥è‡³2021å¹´6æœˆ30æ—¥æœŸé—´åœ¨æœå…‹å¤§å­¦å¥åº·ç³»ç»Ÿè¿›è¡Œçš„ç­›æŸ¥æ€§èƒ¸éƒ¨CTæ‰«æã€‚é€šè¿‡ä½¿ç”¨åœ¨LUNA16æ•°æ®é›†ä¸Šè®­ç»ƒçš„å…¬å¼€å¯ç”¨æ·±åº¦å­¦ä¹ ç»“èŠ‚æ£€æµ‹ç®—æ³•æ¥è¯†åˆ«åˆå§‹å€™é€‰è€…ï¼Œç„¶åæ ¹æ®æ”¾å°„å­¦æ–‡æœ¬æŠ¥å‘Šä¸­çš„ç»“èŠ‚ä½ç½®è¿›è¡Œæ¥å—ï¼Œæˆ–ç”±åŒ»å­¦ç”Ÿå’Œç»è¿‡åŸ¹è®­çš„å¿ƒèƒ¸æ”¾å°„ç§‘ä¸“å®¶æ‰‹åŠ¨æ ‡æ³¨ï¼Œä»è€Œå®ç°äº†é«˜æ•ˆçš„ç»“èŠ‚æ ‡æ³¨ã€‚

**ç»“æœï¼š** è¯¥æ•°æ®é›†åŒ…å«1613ä¸ªCTä½“ç§¯å’Œ2487ä¸ªæ ‡æ³¨çš„ç»“èŠ‚ï¼Œä»æ€»å…±2061åæ‚£è€…çš„æ•°æ®é›†ä¸­é€‰æ‹©ï¼Œå…¶ä½™æ•°æ®ä¿ç•™ç”¨äºæœªæ¥æµ‹è¯•ã€‚æ”¾å°„ç§‘åŒ»ç”ŸæŠ½æŸ¥ç¡®è®¤åŠè‡ªåŠ¨æ ‡æ³¨çš„å‡†ç¡®ç‡è¶…è¿‡90%ã€‚

**ç»“è®ºï¼š** æœå…‹å¤§å­¦è‚ºç™Œç­›æŸ¥æ•°æ®é›†2024æ˜¯é¦–ä¸ªåæ˜ å½“å‰CTæŠ€æœ¯ä½¿ç”¨çš„å¤§å‹CTç­›æŸ¥è‚ºç™Œæ•°æ®é›†ã€‚è¿™ä»£è¡¨äº†è‚ºç™Œé£é™©åˆ†ç±»ç ”ç©¶çš„æœ‰ç”¨èµ„æºï¼Œå…¶åˆ›å»ºä¸­æè¿°çš„é«˜æ•ˆæ ‡æ³¨æ–¹æ³•å¯ç”¨äºåœ¨æœªæ¥ç”Ÿæˆç±»ä¼¼çš„ç ”ç©¶æ•°æ®åº“ã€‚

## [DLCSD24æ ‡æ³¨å¯è§†åŒ–](https://github.com/fitushar/AI-in-Lung-Health-Benchmarking-Detection-and-Diagnostic-Models-Across-Multiple-CT-Scan-Datasets/blob/main/Visualize_DLCSD24.ipynb)

æ­¤ç¬”è®°æœ¬æä¾›äº†ä¸€ä¸ªè„šæœ¬ï¼Œé€šè¿‡åœ¨CTæ‰«æä¸Šå åŠ **æ ‡æ³¨æ¡†**æ¥å¯è§†åŒ–**DLCSD24**æ ‡æ³¨ã€‚å®ƒè¿˜å…è®¸è¿‡æ»¤ç‰¹å®šçš„æ•°æ®é›†æ‹†åˆ†ï¼ˆè®­ç»ƒã€éªŒè¯ã€æµ‹è¯•ï¼‰ä»¥è¿›è¡Œé’ˆå¯¹æ€§åˆ†æã€‚è®¾ç½®æ•°æ®é›†è·¯å¾„ä»¥è®¿é—®åŸå§‹CTæ‰«æå’Œç›¸åº”çš„å…ƒæ•°æ®ï¼Œå®ƒè¿˜å…è®¸è¿‡æ»¤ç‰¹å®šçš„æ•°æ®é›†æ‹†åˆ†ï¼ˆè®­ç»ƒã€éªŒè¯ã€æµ‹è¯•ï¼‰ä»¥è¿›è¡Œé’ˆå¯¹æ€§åˆ†æã€‚

```python
raw_data_path = 'path/to/DLCS24/'
dataset_csv   = 'path/to/Zenodo_metadata/DLCSD24_Annotations.csv'
Final_dect    = df[(df['benchmark_split']=='test')]['ct_nifti_file'].unique()
```

**é‡è¦ï¼š** âš ï¸
**DLCSD24**å’Œ**NLST**æ•°æ®é›†åœ¨ç»˜åˆ¶å¯è§†åŒ–æ—¶ä½¿ç”¨ç•¥æœ‰ä¸åŒçš„**å›¾åƒåæ ‡ç³»ç»Ÿ**ã€‚
è¦æ­£ç¡®åœ°åœ¨**CTå›¾åƒä¸Šå åŠ æ ‡æ³¨**ï¼Œè¯·éµå¾ªæä¾›çš„è„šæœ¬ä»¥ç¡®ä¿æ­£ç¡®çš„åæ ‡å¯¹é½ã€‚
ä½¿ç”¨ä¸æ­£ç¡®çš„åæ ‡ç³»ç»Ÿå¯èƒ½å¯¼è‡´å¯è§†åŒ–é”™ä½å’Œè§£é‡Šä¸­çš„æ½œåœ¨æ··æ·†ã€‚



## [NLST](https://github.com/fitushar/AI-in-Lung-Health-Benchmarking-Detection-and-Diagnostic-Models-Across-Multiple-CT-Scan-Datasets/tree/main/NLST_Data_Annotations)

å¯¹äº[å›½å®¶è‚ºéƒ¨ç­›æŸ¥è¯•éªŒ(NLST)](https://www.nejm.org/doi/full/10.1056/NEJMoa1208962)ï¼Œåœ¨æ£€æµ‹è¯„ä¼°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†[Mikhaelç­‰äºº(2023)](https://doi.org/10.1200/JCO.22.01345)æä¾›çš„å¼€æ”¾è®¿é—®æ ‡æ³¨ã€‚æˆ‘ä»¬å°†æ¥è‡ª900å¤šåè‚ºç™Œæ‚£è€…çš„9,000å¤šä¸ª2Dåˆ‡ç‰‡çº§è¾¹ç•Œæ¡†æ ‡æ³¨è½¬æ¢ä¸º3Dè¡¨ç¤ºï¼Œäº§ç”Ÿäº†1,100å¤šä¸ªç»“èŠ‚æ ‡æ³¨ã€‚


ä¸ºäº†ä»2Dæ ‡æ³¨ä¸­æå–3Dæ ‡æ³¨ï¼Œæˆ‘ä»¬é¦–å…ˆéªŒè¯äº†DICOMå›¾åƒä¸­çš„2Dæ ‡æ³¨ã€‚ç„¶åï¼Œæˆ‘ä»¬ä»DICOMå¤´éƒ¨æå–äº†`seriesinstanceuid`ã€`slice_location`å’Œ`slice_number`ã€‚éšåï¼Œå›¾åƒåæ ‡ä½ç½®è¢«è½¬æ¢ä¸ºä¸–ç•Œåæ ‡ã€‚åœ¨ç›¸åº”çš„NIFTIå›¾åƒä¸­éªŒè¯è¿™äº›æ ‡æ³¨åï¼Œæˆ‘ä»¬å°†åŒä¸€ç—…ç¶åœ¨å¤šä¸ªåˆ‡ç‰‡ä¸Šçš„é‡å è¿ç»­2Dæ ‡æ³¨è¿æ¥æˆå•ä¸ª3Dæ ‡æ³¨ã€‚

ç”Ÿæˆ3Dæ ‡æ³¨çš„å®Œæ•´ä»£ç ä»¥åŠæ˜¾ç¤ºè¿™äº›æ ‡æ³¨çš„å¯è§†åŒ–è„šæœ¬å°†å¾ˆå¿«å‘å¸ƒã€‚å¯è§†åŒ–é¢„è§ˆæ˜¾ç¤ºåœ¨æ­¤[Jupyterç¬”è®°æœ¬](https://github.com/fitushar/AI-in-Lung-Health-Benchmarking-Detection-and-Diagnostic-Models-Across-Multiple-CT-Scan-Datasets/blob/main/NLST_Data_Annotations/3D_Annotation_Visualizations_NLST.ipynb)ä¸­ã€‚

## LUNA16

[LUNA16](https://luna16.grand-challenge.org/)æ˜¯LIDC-IDRIæ•°æ®é›†çš„ç²¾ç‚¼ç‰ˆæœ¬ï¼Œç”¨äºå¤–éƒ¨éªŒè¯ï¼Œåº”ç”¨æ ‡å‡†çš„10æŠ˜äº¤å‰éªŒè¯ç¨‹åºè¿›è¡Œè‚ºç»“èŠ‚æ£€æµ‹ã€‚å¯¹äºä½¿ç”¨LUNA16è¿›è¡Œç™Œç—‡è¯Šæ–­åˆ†ç±»ï¼Œæˆ‘ä»¬éµå¾ªäº†å…ˆå‰ç ”ç©¶([Pai, S.ç­‰äºº(2024)](https://www.nature.com/articles/s42256-024-00807-9))çš„æ ‡æ³¨æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆæŒ‡å®šäº†è‡³å°‘æœ‰ä¸€ä½æ”¾å°„ç§‘åŒ»å¸ˆæŒ‡ç¤ºä¸ºæ¶æ€§çš„ç»“èŠ‚ï¼Œå¾—åˆ°677ä¸ªæ ‡æ³¨ç»“èŠ‚ã€‚æ­¤æ–¹æ¡ˆç§°ä¸º"æ”¾å°„ç§‘åŒ»å¸ˆè§†è§‰è¯„ä¼°æ¶æ€§æŒ‡æ•°"(RVAMI)ã€‚



# åŸºå‡†æµ‹è¯• - ç»“èŠ‚æ£€æµ‹

è‚ºç™Œï¼ˆç»“èŠ‚ï¼‰æ£€æµ‹ä»»åŠ¡å®šä¹‰ä¸ºåœ¨3D CTæ‰«æä¸­è¯†åˆ«è‚ºç»“èŠ‚å¹¶ä½¿ç”¨3Dè¾¹ç•Œæ¡†å¯¹å…¶è¿›è¡Œå®šä½ã€‚ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬åˆ©ç”¨[MONAI](https://github.com/Project-MONAI/tutorials/tree/main/detection)æ£€æµ‹å·¥ä½œæµç¨‹æ¥è®­ç»ƒå’ŒéªŒè¯åŸºäºRetinaNetçš„3Dæ£€æµ‹æ¨¡å‹ï¼Œä»è€Œèƒ½å¤Ÿç›´æ¥å®ç°æˆ‘ä»¬çš„åŸºå‡†æ¨¡å‹ã€‚

* **DLCSD-mDï¼š** ä½¿ç”¨DLCSDå¼€å‘æ•°æ®é›†å¼€å‘çš„æ¨¡å‹ï¼Œç»è¿‡300ä¸ªepochçš„è®­ç»ƒï¼Œåœ¨20%çš„å¼€å‘é›†ä¸Šè¿›è¡ŒéªŒè¯ä»¥ç¡®ä¿é€‰æ‹©æœ€ä½³æ¨¡å‹
* **LUNA16-mDï¼š** ä½¿ç”¨[MONAIæ•™ç¨‹æ–‡æ¡£](https://github.com/Project-MONAI/tutorials/tree/main/detection)ä¸­çš„å®˜æ–¹LUNA16 10æŠ˜äº¤å‰éªŒè¯è®­ç»ƒçš„æ¨¡å‹ã€‚


#### é¢„å¤„ç†
æ‰€æœ‰CTä½“ç§¯éƒ½é‡æ–°é‡‡æ ·åˆ°0.7 Ã— 0.7 Ã— 1.25æ¯«ç±³(x, y, z)çš„æ ‡å‡†åŒ–åˆ†è¾¨ç‡ã€‚å›¾åƒçš„å¼ºåº¦å€¼è¢«æˆªæ–­åœ¨-1000åˆ°500 HUä¹‹é—´ï¼Œæ¯ä¸ªä½“ç§¯éƒ½è¢«å½’ä¸€åŒ–ä¸ºå‡å€¼0å’Œæ ‡å‡†å·®1ã€‚æ¨¡å‹ä½¿ç”¨å¤§å°ä¸º192 Ã— 192 Ã— 80 (x, y, z)çš„3Dè¡¥ä¸è¿›è¡Œè®­ç»ƒï¼Œå¹¶åœ¨é¢„æµ‹é˜¶æ®µåº”ç”¨æ»‘åŠ¨çª—å£æ–¹æ³•ä»¥è¦†ç›–æ•´ä¸ªä½“ç§¯ã€‚æ‰€æœ‰æ¨¡å‹éƒ½ä½¿ç”¨ç›¸åŒçš„è¶…å‚æ•°è®­ç»ƒ300ä¸ªepochï¼Œå¹¶æ ¹æ®æœ€ä½éªŒè¯æŸå¤±é€‰æ‹©æœ€ä½³æ¨¡å‹ã€‚

#### è¯„ä¼°æŒ‡æ ‡
ä½¿ç”¨è‡ªç”±å“åº”æ¥æ”¶è€…æ“ä½œç‰¹å¾(FROC)åˆ†æè¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼Œè¯¥åˆ†ææµ‹é‡å„ç§å‡é˜³æ€§ç‡(FPR)ä¸‹çš„çµæ•åº¦ã€‚ä¸»è¦æ€§èƒ½æŒ‡æ ‡æ˜¯åœ¨é¢„å®šä¹‰FPRä¸‹çš„å¹³å‡çµæ•åº¦ï¼šæ¯æ¬¡æ‰«æ1/8ã€1/4ã€1/2ã€1ã€2ã€4å’Œ8ä¸ªå‡é˜³æ€§ï¼Œå¦‚å…ˆå‰ç ”ç©¶ä¸­æ‰€è¿°ã€‚æ­¤å¤–ï¼Œä½¿ç”¨æ¥æ”¶è€…æ“ä½œç‰¹å¾æ›²çº¿ä¸‹é¢ç§¯(AUC)ä»¥åŠ96%ç½®ä¿¡åŒºé—´(CI)è¯„ä¼°ç—…ç¶çº§åˆ«çš„æ€§èƒ½ã€‚

## DLCSD-mD è¿è¡Œå’Œç¤ºä¾‹

### | DLCSD-mD 1.1 æ•°æ®é¢„å¤„ç†


### | DLCSD-mD 1.2 è®­ç»ƒé…ç½®å’Œç¯å¢ƒæ–‡ä»¶

æˆ‘ä»¬æä¾›äº†é¢„å¤„ç†çš„æ•°æ®æ‹†åˆ†jsonæ–‡ä»¶ï¼Œå¯åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°ï¼š**/ct_detection/datasplit_folds/DukeLungRADs_trcv4_fold1.json**ï¼Œæ¨¡å‹éœ€è¦ç”¨äºè®­ç»ƒ/éªŒè¯/è¯„ä¼°ã€‚

é¦–å…ˆè¯·æ‰“å¼€**"Config_DukeLungRADS_BaseModel_epoch300_patch192x192y80z.json"**ï¼Œæ›´æ”¹ä»¥ä¸‹å€¼ï¼š

* **"Model_save_path_and_utils"ï¼š** å°†åˆ›å»ºå’Œå­˜å‚¨bashã€configã€resultã€tfevent_trainå’Œtrained_modelæ–‡ä»¶å¤¹çš„ç›®å½•ã€‚
* **"raw_img_path"ï¼š** å­˜å‚¨é‡æ–°é‡‡æ ·å›¾åƒçš„ç›®å½•ã€‚
* **"dataset_info_path"ï¼š** å¦‚æœéœ€è¦ï¼Œå­˜å‚¨å…ƒæ•°æ®çš„ç›®å½•ã€‚
* **"train_cinfig"ï¼š** åœ¨æ­¤é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„è®­ç»ƒè¶…å‚æ•°ã€‚
* **"bash_path"ï¼š** ä¿å­˜åŒ…å«æ¨¡å‹è¿è¡Œå‘½ä»¤çš„bashæ–‡ä»¶çš„ç›®å½•


#### Config_DukeLungRADS_BaseModel_epoch300_patch192x192y80z.json
```ruby
{
  "Model_save_path_and_utils": "path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/",
  "raw_img_path"             : "path/to/Data/LungRADS_resample/",
  "dataset_info_path"        : "path/to/ct_detection/dataset_files/",
  "dataset_split_path"       : "path/to/ct_detection/datasplit_folds/",
  "number_of_folds"          : 4,
  "seed"                     : 200,
  "run_prefix"               : "DukeLungRADS_BaseModel_epoch300_patch192x192y80z",
  "split_prefix"             : "DukeLungRADs_trcv4_fold",
  "train_cinfig"             : "path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/training_config.json",
  "bash_path"                : "path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/bash/"
}

```

#### training_config.json

```ruby
{
	"gt_box_mode": "cccwhd",
	"lr": 1e-2,
	"spacing": [0.703125, 0.703125, 1.25],
	"batch_size": 3,
	"patch_size": [192,192,80],
    "val_interval":  5,
    "val_batch_size": 1,
	"val_patch_size": [512,512,208],
	"fg_labels": [0],
	"n_input_channels": 1,
	"spatial_dims": 3,
	"score_thresh": 0.02,
	"nms_thresh": 0.22,
	"returned_layers": [1,2],
	"conv1_t_stride": [2,2,1],
	"max_epoch": 300,
	"base_anchor_shapes": [[6,8,4],[8,6,5],[10,10,6]],
	"balanced_sampler_pos_fraction": 0.3,
	"resume_training": false,
	"resume_checkpoint_path": "",
  "cached_dir":  "/path/to/data/cache/"
}

```

### | DLCSD-mD 1.3 ç”Ÿæˆè®­ç»ƒ/éªŒè¯ç¯å¢ƒå’ŒBashæ–‡ä»¶

```ruby
bash run.sh
```
#### run.sh
```ruby

python3 /path/to/ct_detection/env_main.py --config /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/Config_DukeLungRADS_BaseModel_epoch300_patch192x192y80z.json
python3 /path/to/ct_detection/bash_main_cvit.py --config /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/Config_DukeLungRADS_BaseModel_epoch300_patch192x192y80z.json

```

### | DLCSD-mD 1.4 è®­ç»ƒ/éªŒè¯

è¯¥æ¨¡å‹å·²ä½¿ç”¨singularityåœ¨é›†ç¾¤ä¸Šè®­ç»ƒï¼Œè¿è¡Œåˆ›å»ºçš„subæ–‡ä»¶å°†å¯åŠ¨è®­ç»ƒ

**åˆ›å»ºæ—¥å¿—æ–‡ä»¶å¤¹ï¼š/path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/bash/slurm_logs/**
```ruby
sbatch run_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1.sub
```
#### run_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1.sub

```ruby
#!/bin/bash

#SBATCH --job-name=CVIT-VNLST_1
#SBATCH --mail-type=END,FAIL    
#SBATCH --mail-user=fakrulislam.tushar@duke.edu
#SBATCH --nodes=1
#SBATCH -w node001
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=16
#SBATCH --gpus=1
#SBATCH --output=/path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/bash/slurm_logs/run_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1_.%j.out
#SBATCH --error=/path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/bash/slurm_logs/run_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1._%j.err

module load singularity/singularity.module
export NVIDIA_VISIBLE_DEVICES=$CUDA_VISIBLE_DEVICES

echo "VNLST Run "
echo "Job Running On "; hostname
echo "Nvidia Visible Devices: $NVIDIA_VISIBLE_DEVICES"

singularity run --nv --bind /path/to /home/ft42/For_Tushar/vnlst_ft42_v1.sif python3 /path/to/ct_detection/training.py -e /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/config/environment_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1.json -c /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/training_config.json
singularity run --nv --bind /path/to /home/ft42/For_Tushar/vnlst_ft42_v1.sif python3 /path/to/ct_detection/testing.py -e /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/config/environment_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1.json -c /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/training_config.json

```

* **æ‚¨ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨Dockerå®¹å™¨å’Œç®€å•çš„pythonè°ƒç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ£€æŸ¥[fitushar/Luna16_Monai_Model_XAI_Project](https://github.com/fitushar/Luna16_Monai_Model_XAI_Project)ä¸­æåˆ°çš„dockerå®¹å™¨è¦æ±‚**

```ruby
python3 /path/to/ct_detection/training.py -e /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/config/environment_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1.json -c /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/training_config.json

python3 /path/to/ct_detection/testing.py -e /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/config/environment_DukeLungRADS_BaseModel_epoch300_patch192x192y80z_fold1.json -c /path/to/ct_detection/DukeLungRADS_BaseModel_epoch300_patch192x192y80z/training_config.json
```


### | DLCSD-mD 1.5 æµ‹è¯•

ğŸš€ å³å°†æ¨å‡º

### | DLCSD-mD 1.6 è¯„ä¼°å’ŒåŸºå‡†æµ‹è¯•


ğŸš€ å³å°†æ¨å‡º


### ä»£ç 

ğŸš€ å³å°†æ¨å‡º


# åŸºå‡†æµ‹è¯• - è‚ºç™Œåˆ†ç±»ä»»åŠ¡


æˆ‘ä»¬å°†è‚ºç™Œåˆ†ç±»ä»»åŠ¡å®šä¹‰ä¸ºç»™å®šä¸€ä¸ªç»“èŠ‚ï¼Œå°†å…¶åˆ†ç±»ä¸ºç™Œç—‡æˆ–éç™Œç—‡ã€‚ä¸ºäº†å¯¹è‚ºç™Œåˆ†ç±»ä»»åŠ¡è¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†äº”ç§ä¸åŒçš„åŸºçº¿æ¨¡å‹ï¼ŒåŒ…æ‹¬éšæœºåˆå§‹åŒ–ã€ç›‘ç£å’Œè‡ªç›‘ç£é¢„è®­ç»ƒæ¨¡å‹ï¼Œä»¥åŠæˆ‘ä»¬å†…éƒ¨æå‡ºçš„æˆ˜ç•¥çƒ­å¯åŠ¨++(SWS++)æ¨¡å‹ã€‚


![ç™Œç—‡åˆ†ç±»](https://github.com/fitushar/AI-in-Lung-Health-Benchmarking-Detection-and-Diagnostic-Models-Across-Multiple-CT-Scan-Datasets/blob/main/readme_figures/cancer_classifications_1.PNG)

* **3D ResNet50**
* **FMCBï¼š** æˆ‘ä»¬é‡‡ç”¨äº†æœ€è¿‘å‘å¸ƒçš„åŸºäºè‡ªç›‘ç£ResNet50çš„åŸºç¡€æ¨¡å‹ï¼Œç§°ä¸º"FMCB"ã€‚æˆ‘ä»¬ä½¿ç”¨å®ƒä¸ºæ¯ä¸ªæ•°æ®ç‚¹æå–4,096ä¸ªç‰¹å¾ï¼Œå¹¶æŒ‰ç…§ä½œè€…çš„å»ºè®®ä½¿ç”¨scikit-learnæ¡†æ¶è®­ç»ƒé€»è¾‘å›å½’æ¨¡å‹ã€‚[Pai, S.ç­‰äºº(2024)](https://www.nature.com/articles/s42256-024-00807-9)
* **Genesisï¼š** Models-Genesisçš„é¢„è®­ç»ƒResNet50ï¼Œåœ¨å…¶ä¸Šæ·»åŠ äº†åˆ†ç±»å±‚å¹¶è¿›è¡Œç«¯åˆ°ç«¯è®­ç»ƒã€‚[Zhou, Z.ç­‰äºº(2021)](https://www.sciencedirect.com/science/article/pii/S1361841520302048)
* **MedNet3Dï¼š** Med3Dçš„é¢„è®­ç»ƒResNet50ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸Šæ·»åŠ äº†åˆ†ç±»å±‚å¹¶è¿›è¡Œç«¯åˆ°ç«¯è®­ç»ƒã€‚[Chen,S.ç­‰äºº(2019)](https://arxiv.org/abs/1904.00625)
* **ResNet50-SWS++ï¼š** æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬æ–°é¢–çš„æˆ˜ç•¥çƒ­å¯åŠ¨++(SWS++)é¢„è®­ç»ƒæ–¹æ³•å¼€å‘äº†ä¸€ä¸ªå†…éƒ¨æ¨¡å‹ã€‚è¯¥æ–¹æ³•æ¶‰åŠè®­ç»ƒResNet50ä»¥å‡å°‘è‚ºç»“èŠ‚æ£€æµ‹ä¸­çš„å‡é˜³æ€§ï¼Œä½¿ç”¨åŸºäºç»“èŠ‚ç½®ä¿¡åº¦åˆ†æ•°çš„ä»”ç»†åˆ†å±‚æ•°æ®é›†ã€‚ç„¶åå°†å¾—åˆ°çš„æ¨¡å‹"ResNet50-SWS++"å¾®è°ƒç”¨äºç«¯åˆ°ç«¯è‚ºç™Œåˆ†ç±»ã€‚[Tushar, F. I.ç­‰äºº(2024)](https://arxiv.org/abs/2405.04605)



# è®­ç»ƒè‚ºç™Œåˆ†ç±»æ¨¡å‹

## ResNet50è®­ç»ƒ

```ruby
python3 path/to/ct_classification/training_AUC_StepLR.py -c /path/to/ct_classification/Model_resnet50/config_train_f1_resnet50.json
```

**|config_train_f1_resnet50.json**

```ruby
{
"Model_save_path_and_utils": "path/to/Model_resnet50/",
"run_prefix"               : "Model_resnet50",
"which_fold"               : 1,

"training_csv_path"   : "/path/to/fold_1_tr.csv",
"validation_csv_path" : "/path/to/fold_1_val.csv",
"data_column_name"    : "unique_Annotation_id_nifti",
"label_column_name"   : "Malignant_lbl",

"training_nifti_dir"    : "path/to/nifti/",
"validation_nifti_dir"  : "path/to/nifti/",

"image_key"           : "img",
"label_key"           : "label",
"img_patch_size"      : [64, 64, 64],
"cache_root_dir"      : "path/to/cache_root_dir/",


"train_batch_size" : 24,
"val_batch_size"   : 24,
"use_sampling"     : false,
"sampling_ratio"   : 1,
"num_worker"       : 8,
"val_interval"     : 5,
"max_epoch"        : 200,
"Model_name"       : "resnet50",
"spatial_dims"     : 3,
"n_input_channels" : 1,
"num_classes"      : 2,
"lr"               : 1e-2,
"resume_training": false,
"resume_checkpoint_path": ""

}
```


## Model Genesisè®­ç»ƒ

```ruby
python3 path/to/ct_classification/training_AUC_StepLR.py -c /path/to/ct_classification/Model_Genesis_FineTuning/config_train_f1_modelGenesis.json
```

**|config_train_f1_modelGenesis.json**

```ruby
{
"Model_save_path_and_utils": "path/to/Model_Genesis_FineTuning/",
"run_prefix"               : "DukeLungRADS_Genesis_FineTuning",
"which_fold"               : 1,

"training_csv_path"   : "/path/to/fold_1_tr.csv",
"validation_csv_path" : "/path/to/fold_1_val.csv",
"data_column_name"    : "unique_Annotation_id_nifti",
"label_column_name"   : "Malignant_lbl",

"training_nifti_dir"    : "path/to/nifti/",
"validation_nifti_dir"  : "path/to/nifti/",

"image_key"           : "img",
"label_key"           : "label",
"img_patch_size"      : [64, 64, 64],
"cache_root_dir"      : "path/to/cache_root_dir/",


"train_batch_size" : 24,
"val_batch_size"   : 24,
"use_sampling"     : false,
"sampling_ratio"   : 1,
"num_worker"       : 8,
"val_interval"     : 5,
"max_epoch"        : 200,
"Model_name"       : "Model_Genesis",
"spatial_dims"     : 3,
"n_input_channels" : 1,
"num_classes"      : 2,
"lr"               : 1e-2,
"resume_training": false,
"resume_checkpoint_path": ""

}
```

### Model MedNet3Dè®­ç»ƒ

```ruby
python3 path/to/ct_classification/training_AUC_StepLR.py -c /path/to/ct_classification/Model_MedicalNet3D_FineTuning/config_train_f1_MedicalNet3D_resnet50.json
```

**|config_train_f1_MedicalNet3D_resnet50.json**
```ruby
{
"Model_save_path_and_utils": "/path/to/Model_MedicalNet3D_FineTuning/",
"run_prefix"               : "DukeLungRADS_MedicalNet3D_FineTuning",
"which_fold"               : 1,

"training_csv_path"   : "/path/to/fold_1_tr.csv",
"validation_csv_path" : "/path/to/fold_1_val.csv",
"data_column_name"    : "unique_Annotation_id_nifti",
"label_column_name"   : "Malignant_lbl",

"training_nifti_dir"    : "path/to/nifti/",
"validation_nifti_dir"  : "path/to/nifti/",

"image_key"           : "img",
"label_key"           : "label",
"img_patch_size"      : [64, 64, 64],
"cache_root_dir"      : "path/to/cache_root_dir/",


"train_batch_size" : 24,
"val_batch_size"   : 24,
"use_sampling"     : false,
"sampling_ratio"   : 1,
"num_worker"       : 8,
"val_interval"     : 5,
"max_epoch"        : 200,
"Model_name"       : "resnet50_MedicalNet3D",
"spatial_dims"     : 3,
"n_input_channels" : 1,
"num_classes"      : 2,
"lr"               : 1e-2,
"resume_training": false,
"resume_checkpoint_path": ""

}
```
# å¼•ç”¨æ–‡çŒ®

* Tushar, Fakrul Islam, et al. "AI in Lung Health: Benchmarking Detection and Diagnostic Models Across Multiple CT Scan Datasets." arXiv preprint arXiv:2405.04605 (2024).
* A. Wang, F. I. TUSHAR, M. R. Harowicz, K. J. Lafata, T. D. Tailorand J. Y. Lo, "Duke Lung Cancer Screening Dataset 2024". Zenodo, Mar. 05, 2024. doi: 10.5281/zenodo.13799069.
* Mikhael, Peter G., et al. "Sybil: a validated deep learning model to predict future lung cancer risk from a single low-dose chest computed tomography." Journal of Clinical Oncology 41.12 (2023): 2191-2200.
* Pai, S., Bontempi, D., Hadzic, I. et al. Foundation model for cancer imaging biomarkers. Nat Mach Intell 6, 354â€“367 (2024). https://doi.org/10.1038/s42256-024-00807-9
* Cardoso, M. Jorge, et al. "Monai: An open-source framework for deep learning in healthcare." arXiv preprint arXiv:2211.02701 (2022).
* Z. Zhou, V. Sodha, J. Pang, M. B. Gotway, and J. Liang, "Models genesis," Medical image analysis, vol. 67, p. 101840, 2021.
* S. Chen, K. Ma, and Y. Zheng, "Med3d: Transfer learning for 3d medical image analysis," arXiv preprint arXiv:1904.00625, 2019.
* National Lung Screening Trial Research Team. "Results of initial low-dose computed tomographic screening for lung cancer." New England Journal of Medicine 368.21 (2013): 1980-1991.
* Tushar, Fakrul Islam, et al. "Virtual NLST: towards replicating national lung screening trial." Medical Imaging 2024: Physics of Medical Imaging. Vol. 12925. SPIE, 2024.
* Tushar, Fakrul Islam, et al. "VLST: Virtual Lung Screening Trial for Lung Cancer Detection Using Virtual Imaging Trial." arXiv preprint arXiv:2404.11221 (2024).

